<!-- user-profile.component.html -->
<div class="mx-auto">
    <div class="grid grid-cols-1 lg:grid-cols-4 gap-4">
        <!-- Left Sidebar - Profile Summary -->
        <div class="shadow-lg lg:col-span-1">
            <p-card styleClass="shadow-lg">
                <div class="flex flex-col items-center text-center p-4">
                    <p-avatar [image]="user.profileImage" size="xlarge" shape="circle"
                        styleClass="mb-3 border-2 border-primary-500 p-1"
                        [style]="{'width': '150px', 'height': '150px'}">
                        <ng-template pTemplate="unfoundicon">
                            <span class="text-5xl">{{user.name.charAt(0)}}</span>
                        </ng-template>
                    </p-avatar>
                    <h2 class="text-2xl font-bold mb-1">{{user.name}}</h2>
                    <p class="text-lg text-gray-500 mb-2">{{user.designation}}</p>
                    <p-tag [value]="user.role" severity="info" styleClass="mb-2"></p-tag>
                    <p class="text-sm text-gray-500 mb-4">{{user.department}}</p>

                    <p-divider></p-divider>

                    <div class="w-full text-left grid grid-cols-1 gap-3 mt-4">
                        <div class="flex items-center">
                            <i class="pi pi-id-card mr-3 text-primary-500"></i>
                            <div>
                                <small class="text-gray-500">Employee ID</small>
                                <p class="font-medium">{{user.id}}</p>
                            </div>
                        </div>
                        <div class="flex items-center">
                            <i class="pi pi-envelope mr-3 text-primary-500"></i>
                            <div>
                                <small class="text-gray-500">Email</small>
                                <p class="font-medium">{{user.email}}</p>
                            </div>
                        </div>
                        <div class="flex items-center">
                            <i class="pi pi-phone mr-3 text-primary-500"></i>
                            <div>
                                <small class="text-gray-500">Phone</small>
                                <p class="font-medium">{{user.phone}}</p>
                            </div>
                        </div>
                        <div class="flex items-center">
                            <i class="pi pi-calendar mr-3 text-primary-500"></i>
                            <div>
                                <small class="text-gray-500">Joined On</small>
                                <p class="font-medium">{{user.joiningDate}}</p>
                            </div>
                        </div>
                    </div>

                    <p-divider></p-divider>

                    <div class="w-full text-left mt-4">
                        <h3 class="text-md font-bold mb-3">Skills & Expertise</h3>
                        <div *ngFor="let skill of user.skills" class="mb-2">
                            <div class="flex justify-between mb-1">
                                <span>{{skill.name}}</span>
                                <span>{{skill.level}}%</span>
                            </div>
                            <p-progressBar [value]="skill.level" [showValue]="false"
                                [style]="{'height': '8px'}"></p-progressBar>
                        </div>
                    </div>

                    <div class="w-full mt-6">
                        <p-button label="Edit Profile" icon="pi pi-pencil"
                            styleClass="p-button-rounded w-full"></p-button>
                    </div>
                </div>
            </p-card>
        </div>

        <!-- Main Content Area -->
        <div class="card lg:col-span-3">
            <p-tabView>
                <!-- General Information Tab -->
                <p-tabPanel header="General Information">
                    <div class="p-4">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold">Personal Details</h2>
                            <p-tag [value]="user.status"
                                [severity]="user.status === 'Active' ? 'success' : 'danger'"></p-tag>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="col-span-1">
                                <div class="mb-4">
                                    <h3 class="text-lg font-semibold mb-3">Basic Information</h3>
                                    <div class="grid grid-cols-1 gap-4">
                                        <div class="flex flex-col">
                                            <label class="text-gray-500 text-sm">Full Name</label>
                                            <span class="font-medium">{{user.name}}</span>
                                        </div>
                                        <div class="flex flex-col">
                                            <label class="text-gray-500 text-sm">Gender</label>
                                            <span class="font-medium">{{user.gender}}</span>
                                        </div>
                                        <div class="flex flex-col">
                                            <label class="text-gray-500 text-sm">Blood Group</label>
                                            <span class="font-medium">{{user.bloodGroup}}</span>
                                        </div>
                                        <div class="flex flex-col">
                                            <label class="text-gray-500 text-sm">Qualification</label>
                                            <span class="font-medium">{{user.qualification}}</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="mt-6">
                                    <h3 class="text-lg font-semibold mb-3">Emergency Contact</h3>
                                    <div class="grid grid-cols-1 gap-4">
                                        <div class="flex flex-col">
                                            <label class="text-gray-500 text-sm">Name</label>
                                            <span class="font-medium">{{user.emergencyContact.name}}</span>
                                        </div>
                                        <div class="flex flex-col">
                                            <label class="text-gray-500 text-sm">Relationship</label>
                                            <span class="font-medium">{{user.emergencyContact.relation}}</span>
                                        </div>
                                        <div class="flex flex-col">
                                            <label class="text-gray-500 text-sm">Phone</label>
                                            <span class="font-medium">{{user.emergencyContact.phone}}</span>
                                        </div>
                                        <div class="flex flex-col">
                                            <label class="text-gray-500 text-sm">Address</label>
                                            <span class="font-medium">{{user.emergencyContact.address}}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-span-1">
                                <div class="mb-4">
                                    <h3 class="text-lg font-semibold mb-3">Address Information</h3>
                                    <div class="grid grid-cols-1 gap-4">
                                        <div class="flex flex-col">
                                            <label class="text-gray-500 text-sm">Current Address</label>
                                            <span class="font-medium">{{user.address.current}}</span>
                                        </div>
                                        <div class="flex flex-col">
                                            <label class="text-gray-500 text-sm">Permanent Address</label>
                                            <span class="font-medium">{{user.address.permanent}}</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="mt-6">
                                    <h3 class="text-lg font-semibold mb-3">Documents</h3>
                                    <div class="grid grid-cols-1 gap-4">
                                        <div *ngFor="let doc of user.documents" class="flex items-center">
                                            <i class="pi pi-file mr-2"></i>
                                            <span>{{doc.name}}</span>
                                            <p-tag *ngIf="doc.verified" value="Verified" severity="success"
                                                styleClass="ml-2"></p-tag>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </p-tabPanel>

                <!-- Employment Details Tab -->
                <p-tabPanel header="Employment Details">
                    <div class="p-4">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold">Employment Information</h2>
                            <div class="flex gap-2">
                                <p-chip label="{{user.employmentDetails.employmentType}}" icon="pi pi-clock"></p-chip>
                                <p-chip label="{{user.employmentDetails.currentGrade}}"
                                    icon="pi pi-chart-line"></p-chip>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="col-span-1">
                                <div class="mb-4">
                                    <h3 class="text-lg font-semibold mb-3">Job Details</h3>
                                    <div class="grid grid-cols-1 gap-4">
                                        <div class="flex flex-col">
                                            <label class="text-gray-500 text-sm">Employee ID</label>
                                            <span class="font-medium">{{user.employmentDetails.employeeId}}</span>
                                        </div>
                                        <div class="flex flex-col">
                                            <label class="text-gray-500 text-sm">Department</label>
                                            <span class="font-medium">{{user.employmentDetails.department}}</span>
                                        </div>
                                        <div class="flex flex-col">
                                            <label class="text-gray-500 text-sm">Designation</label>
                                            <span class="font-medium">{{user.employmentDetails.designation}}</span>
                                        </div>
                                        <div class="flex flex-col">
                                            <label class="text-gray-500 text-sm">Reporting Manager</label>
                                            <span class="font-medium">{{user.employmentDetails.reportingManager}}</span>
                                        </div>
                                        <div class="flex flex-col">
                                            <label class="text-gray-500 text-sm">Work Schedule</label>
                                            <span class="font-medium">{{user.employmentDetails.workSchedule}}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-span-1">
                                <div class="mb-4">
                                    <h3 class="text-lg font-semibold mb-3">ID & Bank Details</h3>
                                    <div class="grid grid-cols-1 gap-4">
                                        <div class="flex flex-col">
                                            <label class="text-gray-500 text-sm">Aadhaar Number</label>
                                            <span class="font-medium">{{user.employmentDetails.aadhaarNo}}</span>
                                        </div>
                                        <div class="flex flex-col">
                                            <label class="text-gray-500 text-sm">PAN Number</label>
                                            <span class="font-medium">{{user.employmentDetails.panNo}}</span>
                                        </div>
                                        <div class="flex flex-col">
                                            <label class="text-gray-500 text-sm">Bank Account Number</label>
                                            <span
                                                class="font-medium">{{user.employmentDetails.bankDetails.accountNo}}</span>
                                        </div>
                                        <div class="flex flex-col">
                                            <label class="text-gray-500 text-sm">Bank Name</label>
                                            <span
                                                class="font-medium">{{user.employmentDetails.bankDetails.bankName}}</span>
                                        </div>
                                        <div class="flex flex-col">
                                            <label class="text-gray-500 text-sm">IFSC Code</label>
                                            <span
                                                class="font-medium">{{user.employmentDetails.bankDetails.ifscCode}}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="mt-6">
                            <h3 class="text-lg font-semibold mb-4">Employment Timeline</h3>
                            <p-timeline [value]="events" align="alternate" styleClass="mt-4">
                                <ng-template pTemplate="marker" let-event>
                                    <span class="flex items-center justify-center w-10 h-10 rounded-full"
                                        [style.background-color]="event.color">
                                        <i [class]="event.icon" class="text-white"></i>
                                    </span>
                                </ng-template>
                                <ng-template pTemplate="content" let-event>
                                    <p-card>
                                        <h3 class="text-lg font-medium mb-2">{{event.status}}</h3>
                                        <p class="text-gray-500">{{event.date}}</p>
                                    </p-card>
                                </ng-template>
                            </p-timeline>
                        </div>
                    </div>
                </p-tabPanel>

                <!-- Education & Experience Tab -->
                <p-tabPanel header="Education & Experience">
                    <div class="p-4">
                        <div class="mb-6">
                            <h2 class="text-2xl font-bold mb-4">Educational Qualifications</h2>
                            <div class="grid grid-cols-1 gap-4">
                                <p-card *ngFor="let edu of user.educationHistory" styleClass="shadow-sm">
                                    <div class="flex flex-col md:flex-row md:justify-between">
                                        <div>
                                            <h3 class="text-lg font-semibold mb-1">{{edu.degree}}</h3>
                                            <p class="text-gray-500">{{edu.institution}}</p>
                                        </div>
                                        <div class="mt-2 md:mt-0 text-right">
                                            <p-tag [value]="edu.year" severity="info"></p-tag>
                                            <p class="mt-2 font-medium">Score: {{edu.score}}</p>
                                        </div>
                                    </div>
                                </p-card>
                            </div>
                        </div>

                        <p-divider></p-divider>

                        <div class="my-6">
                            <h2 class="text-2xl font-bold mb-4">Work Experience</h2>
                            <div class="grid grid-cols-1 gap-4">
                                <p-card *ngFor="let work of user.workHistory" styleClass="shadow-sm">
                                    <div class="flex flex-col md:flex-row md:justify-between">
                                        <div>
                                            <h3 class="text-lg font-semibold mb-1">{{work.position}}</h3>
                                            <p class="text-gray-500">{{work.organization}}</p>
                                            <p class="mt-2">{{work.description}}</p>
                                        </div>
                                        <div class="mt-2 md:mt-0 text-right">
                                            <p-tag [value]="work.period" severity="warn"></p-tag>
                                        </div>
                                    </div>
                                </p-card>
                            </div>
                        </div>

                        <p-divider></p-divider>

                        <div class="mt-6">
                            <h2 class="text-2xl font-bold mb-4">Achievements</h2>
                            <ul class="list-disc pl-6">
                                <li *ngFor="let achievement of user.achievements" class="mb-2">
                                    {{achievement}}
                                </li>
                            </ul>
                        </div>
                    </div>
                </p-tabPanel>

                <!-- Role & Permissions Tab -->
                <p-tabPanel header="Role & Permissions">
                    <div class="p-4">
                        <div class="mb-6">
                            <h2 class="text-2xl font-bold mb-2">User Role</h2>
                            <p class="text-gray-500 mb-4">Current assigned role and system permissions</p>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <p-card styleClass="shadow-sm">
                                    <div class="text-center">
                                        <div class="text-5xl text-primary-500 mb-4">
                                            <i class="pi pi-user"></i>
                                        </div>
                                        <h3 class="text-xl font-bold mb-2">{{user.role}}</h3>
                                        <p class="text-gray-500">School Staff Member</p>
                                    </div>
                                </p-card>

                                <div>
                                    <h3 class="text-lg font-semibold mb-3">System Permissions</h3>
                                    <div class="grid grid-cols-1 gap-3">
                                        <div *ngFor="let perm of user.rolePermissions"
                                            class="flex justify-between items-center p-3 bg-gray-50 rounded">
                                            <span>{{perm.name}}</span>
                                            <p-tag [value]="getRoleTagText(perm.access)"
                                                [severity]="getRoleTagSeverity(perm.access)"></p-tag>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </p-tabPanel>
            </p-tabView>
        </div>
    </div>
</div>